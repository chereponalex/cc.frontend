import{j as e,ap as ge,r as h,u as ue}from"./index-DB17ow0B.js";import{B as x,p as H,n as me,o as je,r as ve,y as Ce,A as fe,a0 as Se,E as Te,s as we,q as ye}from"./Button-CAjmaRgO.js";import{D as P}from"./Tag-56vMD8vs.js";import{T as b,b as N}from"./index-BB8TQc6p.js";import{D as be,t as Ne,N as Ae}from"./toast-D1G-7zs5.js";import{D as Ie,T as J,a as g}from"./Upload-C9WU0jIo.js";import{I as M}from"./Input-DH-WCHZ2.js";import{S as Ee}from"./Badge-CQXMuIXM.js";import{T as u}from"./index-Bcac-H9A.js";import{T as o}from"./tabs-DTtIdvQN.js";import"./Alert-ByogqZv3.js";import"./index-BLURZrR2.js";import"./index-DNghyaU3.js";import"./ScrollBar-uf-ZekKR.js";import{r as O}from"./Views-DXqaN0_h.js";import{u as ze}from"./useTranslation-BAWqLgco.js";const Re=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"16",viewBox:"0 -960 960 960",width:"16",fill:"currentColor",children:e.jsx("path",{d:"M440-320h80v-166l64 62 56-56-160-160-160 160 56 56 64-62v166ZM280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520Zm-400 0v520-520Z"})}),De=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"30",viewBox:"0 -960 960 960",width:"30",fill:"currentColor",children:e.jsx("path",{d:"M440-320h80v-166l64 62 56-56-160-160-160 160 56 56 64-62v166ZM280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520Zm-400 0v520-520Z"})}),{TabNav:L,TabList:$e,TabContent:X}=J;function ke(Q){const{columns:V=[],textConst:n,data:c=null,loading:A=!1,noTab:q=!1,getData:Y,SoftDelete:f,SoftDeleteMass:U,HardDelete:ee,Recovery:I,RecoveryMass:Z,noActions:te,noCheckBoxes:E,noBtn:ae}=Q,{t:s}=ze(),S=ge(),[T,w]=h.useState([]),[se,K]=h.useState(!1),[ne,ie]=h.useState(!1),[v,le]=h.useState(!1),[r,oe]=h.useState(o.ACTIVE),[l,m]=h.useState({total:0,pageIndex:1,pageSize:n===b.TRANSACTION?100:25,selectedRows:[],selectedRow:"",query:"",sort:[]}),[j,z]=h.useState([]),re=ue(t=>t.theme.direction);h.useEffect(()=>{w([])},[r]);const ce=()=>{le(!v)},p=(t,a)=>{Ne.push(e.jsx(Ae,{title:s(`toast.title.${t}`),type:t,children:a}))},R=(t,a)=>{m(t?i=>({...i,selectedRows:[...i.selectedRows,a.id]}):i=>({...i,selectedRows:[...i.selectedRows.filter(d=>d!==a.id)]}))},G=async t=>{try{r===o.ACTIVE&&f?(await f(t).unwrap(),p(g.SUCCESS,s(`toast.message.${n}.addInBasket`))):(await ee(t).unwrap(),p(g.SUCCESS,s(`toast.message.${n}.delete`)))}catch(a){console.log(a),p(g.WARNING,a.message)}},he=async t=>{try{if(r===o.ACTIVE&&U){const a=await U({ids:t}).unwrap();a!=null&&a.data.error||p(g.SUCCESS,s(`toast.message.${n}.addInBasket`))}}catch(a){console.log(a),p(g.WARNING,a.message)}},de=async t=>{try{r===o.BASKET&&I?(await I(t).unwrap(),p(g.SUCCESS,s(`toast.message.${n}.recovery`))):S(`${O[n]}/${t}/?editPage=true`)}catch(a){console.log(a),p(g.WARNING,a.message)}},pe=async t=>{try{r===o.BASKET&&Z&&(await Z({ids:t}).unwrap(),p(g.SUCCESS,s(`toast.message.${n}.recovery`)))}catch(a){console.log(a),p(g.WARNING,a.message)}},D=h.useMemo(()=>[...V,...te?[]:[{header:s("table.columnsHeader.action"),id:"action",cell:t=>e.jsx("div",{className:"flex justify-center",children:q?e.jsx(u,{title:r===o.ACTIVE&&f?s(`tooltip.${n}.sendToCart`):s(`tooltip.${n}.delete`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(H,{}),onClick:()=>G(t.row.original.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(u,{title:s(`tooltip.${n}.view`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(me,{}),onClick:()=>{S(`${t.row.original.id}`)}})}),I&&e.jsx(u,{title:r===o.ACTIVE?s(`tooltip.${n}.edit`):s(`tooltip.${n}.recovery`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:r===o.ACTIVE?e.jsx(je,{}):e.jsx(Re,{}),onClick:()=>de(t.row.original.id)})}),e.jsx(u,{title:s(`tooltip.${n}.duplicateAndCreatElement`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(ve,{}),onClick:()=>S(`${O[n]}/creat-new/${t.row.original.id}/?duplicate=true`)})}),e.jsx(u,{title:r===o.ACTIVE&&f?s(`tooltip.${n}.sendToCart`):s(`tooltip.${n}.delete`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(H,{}),onClick:()=>G(t.row.original.id)})})]})})}]],[r,V]),$=t=>{m(a=>({...a,pageIndex:t}))},k=t=>{m(a=>({...a,pageSize:t}))},xe=()=>{z(t=>[...t.map(a=>({...a,value:""}))])},y=(t,a)=>{z(i=>[...i.map(d=>d.name===t?{...d,value:a}:d)])},B=({order:t,key:a})=>{m(i=>{if(!i.sort.length)return{...i,sort:[{order:t,key:a}]};let d=[];return t&&(d=i.sort.map(C=>C.key===a?{...C,order:t}:{order:t,key:a})),{...i,sort:d}})},F=h.useMemo(()=>{let t={};return j.length&&j.map(a=>{a.value!==""&&(t[a.name]=a.value)}),t},[j]),W=async()=>{const t=Object.keys(F).length?Object.assign(F,{page:l.pageIndex,per_page:l.pageSize}):{page:l.pageIndex,per_page:l.pageSize};l.sort.length&&l.sort.map(a=>{t[`sort[${a.key}]`]=a.order}),r===o.BASKET&&(t.trashed="only");try{const a=await Y(t).unwrap();a&&(ie(!0),m(i=>{var d,C,_;return{...i,total:((d=a.paginate)==null?void 0:d.total)||0,pageIndex:((C=a.paginate)==null?void 0:C.current_page)||1,pageSize:((_=a.paginate)==null?void 0:_.per_page)||25}}))}catch(a){console.log(a),p(g.WARNING,a.message)}};return h.useEffect(()=>{W()},[l.pageIndex,l.sort,l.pageSize,r]),h.useEffect(()=>{c&&!ne&&z(c.filters.map(t=>({...t,value:""})))},[c]),e.jsxs(e.Fragment,{children:[!!j.length&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer select-none",onClick:ce,children:[e.jsx("span",{className:"text-lg",children:v?e.jsx(fe,{}):e.jsx(Ce,{})}),e.jsx("h6",{children:s("global.filters")}),e.jsx(Se,{}),e.jsxs("span",{children:["(",j.length,")"]})]}),e.jsx("hr",{className:"mx-3 w-full"}),!!Object.keys(F).length&&e.jsx(u,{title:s("global.resetAllFilters"),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(Te,{color:"red"}),onClick:xe})})]}),e.jsxs(we.div,{className:"grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4 my-1",initial:{opacity:0,height:0,overflow:"hidden"},animate:{opacity:v?1:0,height:v?"auto":0,overflow:v?"visible":"hidden"},transition:{duration:.15},children:[j.map((t,a)=>e.jsxs("div",{children:[t.type===N.DATE&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{style:{fontSize:"12px"},className:"mb-1",children:t.label}),e.jsx(Ie,{value:t.value,placeholder:t.placeholder||"",onChange:i=>{y(t.name,i)}})]}),t.type===N.INPUT&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{style:{fontSize:"12px"},className:"mb-1",children:t.label}),e.jsx(M,{size:"xs",value:t.value,placeholder:t.placeholder||"",onChange:i=>{y(t.name,i.target.value)}})]}),t.type===N.NUMBER&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{style:{fontSize:"12px"},className:"mb-1",children:t.label}),e.jsx(M,{size:"xs",value:t.value,type:"number",placeholder:t.placeholder||"",onChange:i=>{y(t.name,i.target.value)}})]}),t.type===N.CHECKBOX&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{style:{fontSize:"12px"},className:"mb-1",children:t.label}),e.jsx(Ee,{size:"xs",defaultValue:t.value,options:t.options,placeholder:t.placeholder||"",onChange:i=>{y(t.name,i.value)}})]})]},`${t.name}-${a}`)),e.jsx("div",{className:"xl:col-span-4 lg:col-span-3 md:col-span-2 col-span-1",children:e.jsx(x,{size:"xs",className:"float-right",onClick:W,children:s("global.applyFilters")})})]})]}),!ae&&e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx(M,{size:"xs",placeholder:s("global.search"),className:"max-w-80"}),e.jsx(x,{size:"xs",className:"float-right",icon:e.jsx(ye,{}),onClick:()=>{S(`${O[n]}/creat-new`)},children:s(`${n}Page.buttons.createNew`)})]}),q?e.jsx(P,{transaction:n===b.TRANSACTION,noCheckBoxes:E,setSelectedRowsData:w,columns:D,selectable:!0,data:(c==null?void 0:c.data)||[],loading:A,pagingData:{total:l.total,pageIndex:l.pageIndex,pageSize:l.pageSize},onPaginationChange:$,onSelectChange:k,onSort:B,onCheckBoxChange:R}):e.jsxs(J,{value:r,onChange:t=>oe(t),children:[e.jsx($e,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(L,{value:o.ACTIVE,children:s("tabsText.active")}),e.jsx(L,{value:o.BASKET,children:s("tabsText.basket")})]}),r===o.ACTIVE&&T.length>0&&e.jsx(u,{title:s(`tooltip.${n}.delete`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(H,{style:{width:"30px",height:"30px"}}),onClick:()=>he(T)})}),r===o.BASKET&&T.length>0&&e.jsx(u,{title:s(`tooltip.${n}.recovery`),children:e.jsx(x,{shape:"circle",variant:"plain",size:"xs",icon:e.jsx(De,{}),onClick:()=>pe(T)})})]})}),e.jsxs("div",{className:"py-4",children:[e.jsx(X,{value:o.ACTIVE,children:e.jsx(P,{transaction:n===b.TRANSACTION,noCheckBoxes:E,setSelectedRowsData:w,columns:D,selectable:!0,data:(c==null?void 0:c.data)||[],loading:A,pagingData:{total:l.total,pageIndex:l.pageIndex,pageSize:l.pageSize},onPaginationChange:$,onSelectChange:k,onSort:B,onCheckBoxChange:R})}),e.jsx(X,{value:o.BASKET,children:e.jsx(P,{transaction:n===b.TRANSACTION,noCheckBoxes:E,setSelectedRowsData:w,columns:D,selectable:!0,data:(c==null?void 0:c.data)||[],loading:A,pagingData:{total:l.total,pageIndex:l.pageIndex,pageSize:l.pageSize},onPaginationChange:$,onSelectChange:k,onSort:B,onCheckBoxChange:R})})]})]}),e.jsx(be,{title:s("DrawerText.title.warning"),isOpen:se,placement:re==="rtl"?"left":"right",width:375,onClose:()=>K(!1),onRequestClose:()=>K(!1),children:e.jsx("div",{children:e.jsx("div",{children:s("DrawerText.description.blockedUser")})})})]})}const Je=ke;export{Je as T};
